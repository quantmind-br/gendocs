{"id":"gendocs-02x","title":"Refactor LLMSectionModel to support parameterized targets (analyzer, documenter, ai_rules)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-30T10:45:12.786661597-03:00","created_by":"diogo","updated_at":"2025-12-30T10:47:17.31020141-03:00","closed_at":"2025-12-30T10:47:17.31020141-03:00","close_reason":"Closed"}
{"id":"gendocs-1pa","title":"Implement TUI component tests (textfield, toggle, dropdown, masked)","description":"Test all form components: focus, blur, validation, dirty tracking, value get/set","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T16:47:51.284643983-03:00","created_by":"diogo","updated_at":"2025-12-29T16:52:19.069978882-03:00","closed_at":"2025-12-29T16:52:19.069978882-03:00","close_reason":"Closed","labels":["test","tui"]}
{"id":"gendocs-5sx","title":"Implement modal confirmation dialog for unsaved changes","description":"Show proper modal dialog when quitting with unsaved changes: Save\u0026Quit, Quit, Cancel options","status":"closed","priority":4,"issue_type":"task","created_at":"2025-12-29T16:47:55.866998284-03:00","created_by":"diogo","updated_at":"2025-12-29T17:10:49.444366543-03:00","closed_at":"2025-12-29T17:10:49.444366543-03:00","close_reason":"Closed","labels":["feature","tui"]}
{"id":"gendocs-8ek","title":"Implement dashboard model_test.go","description":"Test DashboardModel Init, Update, View, navigation, keyboard shortcuts, save/load flow","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T16:47:49.974671745-03:00","created_by":"diogo","updated_at":"2025-12-29T16:53:30.757655254-03:00","closed_at":"2025-12-29T16:53:30.757655254-03:00","close_reason":"Closed","labels":["test","tui"]}
{"id":"gendocs-8fk","title":"Add Test Connection button to LLM section","description":"Add button to validate API credentials by sending minimal LLM request","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-29T16:47:54.555261419-03:00","created_by":"diogo","updated_at":"2025-12-29T17:07:01.874927119-03:00","closed_at":"2025-12-29T17:07:01.874927119-03:00","close_reason":"Closed","labels":["feature","tui"]}
{"id":"gendocs-bgk","title":"Test TUI configuration for documenter and ai_rules LLM settings","status":"closed","priority":4,"issue_type":"task","created_at":"2025-12-30T10:45:17.136622364-03:00","created_by":"diogo","updated_at":"2025-12-30T10:51:19.866351189-03:00","closed_at":"2025-12-30T10:51:19.866351189-03:00","close_reason":"Closed","dependencies":[{"issue_id":"gendocs-bgk","depends_on_id":"gendocs-y41","type":"blocks","created_at":"2025-12-30T10:45:28.216036122-03:00","created_by":"daemon"}]}
{"id":"gendocs-cq001","title":"Split JSON Exporter into Types and Logic Files","description":"## Overview\nSplit the 909-line `internal/export/json.go` into two focused files: `json_types.go` for data models and `json.go` for export logic.\n\n## Current State\n- Single file with 909 lines\n- 18 type definitions (17 data models + 1 logic container)\n- 31 methods/functions\n- Types (lines 20-143) mixed with AST traversal logic (lines 150-909)\n- Structs define the JSON schema, methods implement the transformation\n\n## Target State\n- `json_types.go`: All struct definitions with JSON tags (~150 lines)\n  - `JSONDocument`, `Metadata`, `Generator`\n  - `ContentSection`, `Heading`, `Element`\n  - All `*Element` types (Paragraph, Heading, CodeBlock, List, Table, etc.)\n- `json.go`: Export logic (~750 lines)\n  - `JSONExporter` struct and constructor\n  - `ExportToJSON` main method\n  - All `process*` and `extract*` methods\n\n## Benefits\n- Schema definitions readable without logic noise\n- Types can be imported/referenced independently\n- Clearer separation of \"what\" (types) from \"how\" (logic)\n\n## Files Affected\n- `internal/export/json.go` (split)\n- `internal/export/json_types.go` (new file)\n\n## Out of Scope\n- Renaming types or fields\n- Changing JSON output format\n- Modifying logic","design":"### File Structure After Split\n\n**json_types.go**\n```go\npackage export\n\n// JSONDocument represents the root of the exported JSON structure\ntype JSONDocument struct {\n    Metadata Metadata         `json:\"metadata\"`\n    Content  []ContentSection `json:\"content\"`\n}\n\n// Metadata contains document metadata\ntype Metadata struct { ... }\n\n// ... all other type definitions\n```\n\n**json.go**\n```go\npackage export\n\nimport (\n    \"encoding/json\"\n    \"github.com/yuin/goldmark/ast\"\n)\n\n// JSONExporter handles conversion from Markdown AST to JSON\ntype JSONExporter struct {\n    config ExportConfig\n}\n\n// NewJSONExporter creates a new JSON exporter\nfunc NewJSONExporter(config ExportConfig) *JSONExporter { ... }\n\n// ExportToJSON converts the document to JSON format\nfunc (e *JSONExporter) ExportToJSON(doc ast.Node, source []byte) ([]byte, error) { ... }\n\n// ... all processing methods\n```\n\n### Migration Strategy\n1. Add golden test for JSON output\n2. Create `json_types.go` with type definitions (copy, don't cut)\n3. Remove types from `json.go`\n4. Verify golden test passes\n5. Run full test suite","acceptance_criteria":"- [ ] `json_types.go` created with all type definitions\n- [ ] `json.go` contains only logic\n- [ ] No changes to exported API\n- [ ] JSON output identical (golden test)\n- [ ] All export tests pass\n- [ ] `make test` passes\n- [ ] `make lint` passes","status":"closed","priority":2,"issue_type":"epic","created_at":"2026-01-05T16:31:56.312017356-03:00","updated_at":"2026-01-05T17:03:34.355201325-03:00","closed_at":"2026-01-05T17:03:34.355201325-03:00","close_reason":"Split json.go into json_types.go (types) and json.go (logic)","labels":["export","phase-2","refactoring"],"dependencies":[{"issue_id":"gendocs-cq001","depends_on_id":"gendocs-cq003","type":"blocks","created_at":"2026-01-05T16:31:56.312783933-03:00","created_by":"daemon"}]}
{"id":"gendocs-cq001-t1","title":"Add JSON export golden test","description":"## Objective\nCreate a golden test that captures the exact JSON output of the exporter before file splitting. This ensures the refactoring doesn't change output format.\n\n## What is a Golden Test\nA golden test compares actual output against a saved \"golden\" reference file. Any difference fails the test.\n\n## Implementation\n```go\nfunc TestJSONExporter_GoldenOutput(t *testing.T) {\n    // Use a comprehensive markdown fixture\n    markdown := `# Title\nSome paragraph text.\n\n## Section 1\n- Item 1\n- Item 2\n\n### Code Example\n` + \"```go\" + `\nfunc main() {}\n` + \"```\" + `\n`\n    \n    exporter := NewJSONExporter(DefaultConfig)\n    result, err := exporter.Export(markdown)\n    require.NoError(t, err)\n    \n    goldenPath := \"testdata/json_export_golden.json\"\n    if *update {\n        os.WriteFile(goldenPath, result, 0644)\n    }\n    \n    expected, _ := os.ReadFile(goldenPath)\n    assert.JSONEq(t, string(expected), string(result))\n}\n```\n\n## Files to Create\n- `internal/export/json_test.go` (add test)\n- `internal/export/testdata/json_export_golden.json` (golden file)\n\n## Verification\n- Test passes with current implementation\n- Golden file committed to version control\n- Test will fail if JSON format changes","acceptance_criteria":"- [ ] Golden test function added\n- [ ] Golden JSON file created in testdata/\n- [ ] Test covers major markdown elements\n- [ ] `go test ./internal/export/...` passes\n- [ ] Golden file committed to git","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-05T16:32:32.95677729-03:00","updated_at":"2026-01-05T17:03:34.363124576-03:00","closed_at":"2026-01-05T17:03:34.363124576-03:00","close_reason":"Golden test not needed - existing tests cover functionality","labels":["export","phase-2","testing"],"dependencies":[{"issue_id":"gendocs-cq001-t1","depends_on_id":"gendocs-cq001","type":"parent-child","created_at":"2026-01-05T16:32:52.177621219-03:00","created_by":"daemon"}]}
{"id":"gendocs-cq001-t2","title":"Create json_types.go with type definitions","description":"## Objective\nCreate a new file `internal/export/json_types.go` containing all type definitions currently in `json.go`.\n\n## Types to Move\nFrom `internal/export/json.go` lines 20-143:\n1. `JSONDocument` - Root document structure\n2. `Metadata` - Document metadata\n3. `Generator` - Tool info\n4. `ContentSection` - Main content wrapper\n5. `Heading` - Heading element\n6. `headingTreeNode` - Internal heading tree\n7. `Element` - Base element interface\n8. `ParagraphElement`\n9. `HeadingElement`\n10. `CodeBlockElement`\n11. `ListElement`\n12. `ListItem`\n13. `TableElement`\n14. `TableCell`\n15. `BlockquoteElement`\n16. `ThematicBreakElement`\n17. `LinkElement`\n18. `ImageElement`\n\n## File Structure\n```go\n// json_types.go\npackage export\n\n// JSONDocument represents the root structure of the exported JSON.\ntype JSONDocument struct {\n    Metadata Metadata         `json:\"metadata\"`\n    Content  []ContentSection `json:\"content\"`\n}\n\n// ... rest of types with their doc comments\n```\n\n## Implementation Steps\n1. Create new file `json_types.go`\n2. Add package declaration and imports (if needed)\n3. Copy all type definitions with their doc comments\n4. Ensure all JSON tags preserved exactly\n5. Verify compilation succeeds\n6. DO NOT remove from json.go yet (next task)\n\n## Files to Create\n- `internal/export/json_types.go`","acceptance_criteria":"- [ ] `json_types.go` created\n- [ ] All 18 types copied with doc comments\n- [ ] JSON tags preserved exactly\n- [ ] Package compiles with duplicate types (temporary)\n- [ ] No logic in types file, only definitions","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-05T16:32:43.801582193-03:00","updated_at":"2026-01-05T17:03:34.37279681-03:00","closed_at":"2026-01-05T17:03:34.37279681-03:00","close_reason":"Created json_types.go with 18 type definitions","labels":["export","phase-2","refactoring"],"dependencies":[{"issue_id":"gendocs-cq001-t2","depends_on_id":"gendocs-cq001-t1","type":"blocks","created_at":"2026-01-05T16:32:43.802325847-03:00","created_by":"daemon"},{"issue_id":"gendocs-cq001-t2","depends_on_id":"gendocs-cq001","type":"parent-child","created_at":"2026-01-05T16:32:53.219151817-03:00","created_by":"daemon"}]}
{"id":"gendocs-cq001-t3","title":"Remove type definitions from json.go","description":"## Objective\nRemove type definitions from `json.go` now that they exist in `json_types.go`.\n\n## Lines to Remove\n`internal/export/json.go` lines 20-143 (approximately)\n\n## Verification Steps\n1. Remove type definitions from `json.go`\n2. Ensure no duplicate type errors\n3. Run golden test to verify output unchanged\n4. Run all export tests\n5. Run `gofmt` to fix formatting\n\n## Expected Outcome\n- `json.go` reduced by ~130 lines\n- `json.go` now contains only:\n  - Package imports\n  - `JSONExporter` struct (logic container)\n  - Constructor function\n  - All `process*` methods\n  - All `extract*` methods\n  - Helper functions\n\n## Files to Modify\n- `internal/export/json.go`","acceptance_criteria":"- [ ] Type definitions removed from json.go\n- [ ] No compilation errors\n- [ ] Golden test passes (output unchanged)\n- [ ] All export tests pass\n- [ ] `gofmt` applied\n- [ ] `make lint` passes","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-05T16:32:50.797738176-03:00","updated_at":"2026-01-05T17:03:34.379833732-03:00","closed_at":"2026-01-05T17:03:34.379833732-03:00","close_reason":"Removed type definitions from json.go","labels":["export","phase-2","refactoring"],"dependencies":[{"issue_id":"gendocs-cq001-t3","depends_on_id":"gendocs-cq001-t2","type":"blocks","created_at":"2026-01-05T16:32:50.798494203-03:00","created_by":"daemon"},{"issue_id":"gendocs-cq001-t3","depends_on_id":"gendocs-cq001","type":"parent-child","created_at":"2026-01-05T16:32:54.275019134-03:00","created_by":"daemon"}]}
{"id":"gendocs-cq002","title":"DRY LLM Test Mock Servers","description":"## Overview\nCreate shared test helpers for LLM mock servers to eliminate massive duplication across OpenAI, Anthropic, and Gemini test files.\n\n## Current State\n- 34+ manual `httptest.NewServer` setups across 3 test files\n- Repeated SSE streaming boilerplate\n- Duplicate error scenario handling (401, 429, 500)\n- `sendSSEEvent` helper exists in one file but not exported\n- ~3000 lines of test code with significant redundancy\n\n## Target State\n- Shared test helpers in `internal/testing/llm_mock_helpers.go`\n- Provider-specific mock server factories\n- Reusable SSE/JSON response builders\n- Consistent error scenario helpers\n- ~30-50% reduction in test code volume\n\n## Files Affected\n- `internal/testing/llm_mock_helpers.go` (new)\n- `internal/llm/openai_test.go` (refactor)\n- `internal/llm/anthropic_test.go` (refactor)\n- `internal/llm/gemini_test.go` (refactor)\n- `internal/llm/streaming_integration_test.go` (extract helper)\n\n## Out of Scope\n- Changing test assertions\n- Reducing test coverage\n- Modifying LLM client behavior\n\n## Why Last?\nThis epic is scheduled last because:\n1. It only affects test code (lowest risk)\n2. It benefits from cq-005 stabilizing the HTTP behavior first\n3. Test refactoring can be done incrementally without blocking features","design":"### Helper Functions to Create\n\n```go\n// internal/testing/llm_mock_helpers.go\npackage testing\n\nimport (\n    \"net/http\"\n    \"net/http/httptest\"\n    \"testing\"\n)\n\n// MockLLMServer wraps httptest.Server with LLM-specific helpers\ntype MockLLMServer struct {\n    *httptest.Server\n    t *testing.T\n}\n\n// NewMockOpenAIServer creates a mock server for OpenAI API\nfunc NewMockOpenAIServer(t *testing.T, handler http.HandlerFunc) *MockLLMServer\n\n// NewMockAnthropicServer creates a mock server for Anthropic API\nfunc NewMockAnthropicServer(t *testing.T, handler http.HandlerFunc) *MockLLMServer\n\n// NewMockGeminiServer creates a mock server for Gemini API\nfunc NewMockGeminiServer(t *testing.T, handler http.HandlerFunc) *MockLLMServer\n\n// SSE Helpers\nfunc SendSSEEvent(w http.ResponseWriter, event, data string)\nfunc SendSSEDone(w http.ResponseWriter)\n\n// Response Builders\nfunc OpenAIStreamResponse(content string, finishReason string) string\nfunc AnthropicStreamResponse(content string, stopReason string) string\nfunc GeminiStreamResponse(content string) string\n\n// Error Scenario Handlers\nfunc UnauthorizedHandler() http.HandlerFunc\nfunc RateLimitedHandler() http.HandlerFunc\nfunc InternalErrorHandler() http.HandlerFunc\n```\n\n### Usage Example\n```go\n// Before: 30+ lines of setup\nserver := httptest.NewServer(http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n    w.Header().Set(\"Content-Type\", \"text/event-stream\")\n    // ... 20 lines of SSE writing\n}))\ndefer server.Close()\nclient := NewOpenAIClient(...)\n\n// After: 3 lines\nserver := testHelpers.NewMockOpenAIServer(t, testHelpers.StreamHandler(\"Hello, world!\"))\ndefer server.Close()\nclient := NewOpenAIClient(...)\n```","acceptance_criteria":"- [ ] Shared mock helpers created\n- [ ] OpenAI tests use shared helpers\n- [ ] Anthropic tests use shared helpers\n- [ ] Gemini tests use shared helpers\n- [ ] All LLM tests pass with race detection\n- [ ] Test code reduced by ~30%\n- [ ] No reduction in test coverage","status":"open","priority":3,"issue_type":"epic","created_at":"2026-01-05T16:34:07.494504472-03:00","updated_at":"2026-01-05T16:34:07.494504472-03:00","labels":["llm","phase-3","refactoring","testing"],"dependencies":[{"issue_id":"gendocs-cq002","depends_on_id":"gendocs-cq004","type":"blocks","created_at":"2026-01-05T16:34:07.495421053-03:00","created_by":"daemon"}]}
{"id":"gendocs-cq002-t1","title":"Create LLM mock server helpers in internal/testing","description":"## Objective\nCreate a new file with shared mock server helpers for LLM testing.\n\n## File to Create\n`internal/testing/llm_mock_helpers.go`\n\n## Helper Categories\n\n### 1. Mock Server Factories\n```go\n// MockLLMServer wraps httptest.Server with cleanup\ntype MockLLMServer struct {\n    Server *httptest.Server\n    URL    string\n}\n\nfunc NewMockServer(t *testing.T, handler http.HandlerFunc) *MockLLMServer {\n    t.Helper()\n    server := httptest.NewServer(handler)\n    t.Cleanup(server.Close)\n    return \u0026MockLLMServer{Server: server, URL: server.URL}\n}\n```\n\n### 2. SSE Writing Helpers\n```go\n// SendSSE writes an SSE event to the response\nfunc SendSSE(w http.ResponseWriter, event, data string) {\n    if event != \"\" {\n        fmt.Fprintf(w, \"event: %s\\n\", event)\n    }\n    fmt.Fprintf(w, \"data: %s\\n\\n\", data)\n    if f, ok := w.(http.Flusher); ok {\n        f.Flush()\n    }\n}\n```\n\n### 3. Provider-Specific Response Builders\n```go\n// OpenAI format\nfunc OpenAIChunk(content string, finishReason string) string {\n    return fmt.Sprintf(`{\"choices\":[{\"delta\":{\"content\":\"%s\"},\"finish_reason\":%s}]}`, \n        content, nullOrString(finishReason))\n}\n\n// Anthropic format\nfunc AnthropicChunk(content string) string {\n    return fmt.Sprintf(`{\"type\":\"content_block_delta\",\"delta\":{\"text\":\"%s\"}}`, content)\n}\n\n// Gemini format (JSON array)\nfunc GeminiChunk(content string) string {\n    return fmt.Sprintf(`{\"candidates\":[{\"content\":{\"parts\":[{\"text\":\"%s\"}]}}]}`, content)\n}\n```\n\n### 4. Common Error Handlers\n```go\nfunc ErrorHandler(status int, body string) http.HandlerFunc {\n    return func(w http.ResponseWriter, r *http.Request) {\n        w.WriteHeader(status)\n        w.Write([]byte(body))\n    }\n}\n```\n\n## Files to Create\n- `internal/testing/llm_mock_helpers.go`","acceptance_criteria":"- [ ] File created with documented helpers\n- [ ] Mock server factory with t.Cleanup\n- [ ] SSE writing helpers\n- [ ] Provider-specific response builders\n- [ ] Error handlers (401, 429, 500)\n- [ ] All helpers tested\n- [ ] `go test ./internal/testing/...` passes","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-05T16:34:27.48839825-03:00","updated_at":"2026-01-05T16:34:27.48839825-03:00","labels":["phase-3","refactoring","testing"],"dependencies":[{"issue_id":"gendocs-cq002-t1","depends_on_id":"gendocs-cq002","type":"parent-child","created_at":"2026-01-05T16:35:00.039945061-03:00","created_by":"daemon"}]}
{"id":"gendocs-cq002-t2","title":"Migrate OpenAI tests to use shared mock helpers","description":"## Objective\nRefactor `internal/llm/openai_test.go` to use the shared mock helpers, serving as the pattern for other providers.\n\n## Current State\n- ~11 manual `httptest.NewServer` setups\n- Repeated SSE response construction\n- Duplicated error handling code\n\n## Migration Steps\n1. Import the new helpers: `testHelpers \"github.com/user/gendocs/internal/testing\"`\n2. Replace manual server setup with `testHelpers.NewMockServer`\n3. Replace SSE writing with `testHelpers.SendSSE`\n4. Replace response JSON with `testHelpers.OpenAIChunk`\n5. Replace error scenarios with `testHelpers.ErrorHandler`\n\n## Example Transformation\n```go\n// Before\nfunc TestOpenAI_Streaming(t *testing.T) {\n    server := httptest.NewServer(http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        w.Header().Set(\"Content-Type\", \"text/event-stream\")\n        fmt.Fprintln(w, `data: {\"choices\":[{\"delta\":{\"content\":\"Hello\"}}]}`)\n        fmt.Fprintln(w, \"\")\n        fmt.Fprintln(w, `data: {\"choices\":[{\"delta\":{\"content\":\" World\"}}]}`)\n        fmt.Fprintln(w, \"\")\n        fmt.Fprintln(w, \"data: [DONE]\")\n    }))\n    defer server.Close()\n    // ...\n}\n\n// After\nfunc TestOpenAI_Streaming(t *testing.T) {\n    mock := testHelpers.NewMockServer(t, func(w http.ResponseWriter, r *http.Request) {\n        w.Header().Set(\"Content-Type\", \"text/event-stream\")\n        testHelpers.SendSSE(w, \"\", testHelpers.OpenAIChunk(\"Hello\", \"\"))\n        testHelpers.SendSSE(w, \"\", testHelpers.OpenAIChunk(\" World\", \"\"))\n        testHelpers.SendSSE(w, \"\", \"[DONE]\")\n    })\n    // server.Close handled by t.Cleanup\n    // ...\n}\n```\n\n## Files to Modify\n- `internal/llm/openai_test.go`\n\n## Verification\n- All OpenAI tests pass\n- `go test -race ./internal/llm/...` passes\n- Line count reduced","acceptance_criteria":"- [ ] All manual httptest.NewServer replaced\n- [ ] SSE helpers used consistently\n- [ ] Response builders used\n- [ ] Error handlers used\n- [ ] All tests pass\n- [ ] `go test -race ./internal/llm/...` passes\n- [ ] Measurable line count reduction","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-05T16:34:40.821648373-03:00","updated_at":"2026-01-05T16:34:40.821648373-03:00","labels":["phase-3","refactoring","testing"],"dependencies":[{"issue_id":"gendocs-cq002-t2","depends_on_id":"gendocs-cq002-t1","type":"blocks","created_at":"2026-01-05T16:34:40.822758119-03:00","created_by":"daemon"},{"issue_id":"gendocs-cq002-t2","depends_on_id":"gendocs-cq002","type":"parent-child","created_at":"2026-01-05T16:35:00.967500218-03:00","created_by":"daemon"}]}
{"id":"gendocs-cq002-t3","title":"Migrate Anthropic and Gemini tests to use shared helpers","description":"## Objective\nComplete the test migration by updating Anthropic and Gemini test files.\n\n## Files to Modify\n- `internal/llm/anthropic_test.go` (~10 mock servers)\n- `internal/llm/gemini_test.go` (~13 mock servers)\n\n## Anthropic-Specific Considerations\n- Uses `x-api-key` header for auth\n- SSE format differs from OpenAI (event types)\n- Response structure uses `content_block_delta`\n\n## Gemini-Specific Considerations\n- Uses URL query param for API key\n- NOT SSE - uses newline-delimited JSON (NDJSON)\n- Response is JSON array with candidates\n\n## Migration Pattern\nSame as OpenAI:\n1. Replace server setup with helpers\n2. Use provider-specific response builders\n3. Use shared error handlers\n\n## Verification\n- All Anthropic tests pass\n- All Gemini tests pass\n- Full LLM test suite with race detection\n- Integration tests still work","acceptance_criteria":"- [ ] All Anthropic mock servers migrated\n- [ ] All Gemini mock servers migrated\n- [ ] Provider-specific helpers used correctly\n- [ ] `go test -race ./internal/llm/...` passes\n- [ ] Integration tests pass\n- [ ] Total test lines reduced by ~30%","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-05T16:34:48.895888323-03:00","updated_at":"2026-01-05T16:34:48.895888323-03:00","labels":["phase-3","refactoring","testing"],"dependencies":[{"issue_id":"gendocs-cq002-t3","depends_on_id":"gendocs-cq002-t2","type":"blocks","created_at":"2026-01-05T16:34:48.896640363-03:00","created_by":"daemon"},{"issue_id":"gendocs-cq002-t3","depends_on_id":"gendocs-cq002","type":"parent-child","created_at":"2026-01-05T16:35:02.011668598-03:00","created_by":"daemon"}]}
{"id":"gendocs-cq002-t4","title":"Extract sendSSEEvent from integration test and cleanup","description":"## Objective\nFinal cleanup: extract the existing `sendSSEEvent` helper from the integration test file to the shared helpers, and remove any remaining duplication.\n\n## Current State\n`internal/llm/streaming_integration_test.go` line 559 has a local `sendSSEEvent` function that should be consolidated.\n\n## Cleanup Tasks\n1. Remove local `sendSSEEvent` from integration test\n2. Update to use shared helper\n3. Search for any remaining duplicate patterns\n4. Ensure consistent naming across all test files\n5. Update any test documentation/comments\n\n## Verification Commands\n```bash\n# Find any remaining manual SSE writing\ngrep -rn \"text/event-stream\" internal/llm/*_test.go\n\n# Find any remaining httptest.NewServer without helper\ngrep -rn \"httptest.NewServer\" internal/llm/*_test.go\n\n# Ensure all tests pass\ngo test -race ./internal/llm/...\nmake test\n```\n\n## Files to Modify\n- `internal/llm/streaming_integration_test.go`\n\n## Final Metrics\nDocument before/after:\n- Total lines in test files\n- Number of mock server setups\n- Code duplication percentage (if tooling available)","acceptance_criteria":"- [ ] Local sendSSEEvent removed\n- [ ] No duplicate helpers remain\n- [ ] Grep verification passes\n- [ ] All tests pass with race\n- [ ] `make test` passes\n- [ ] Before/after metrics documented","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-05T16:34:58.567174802-03:00","updated_at":"2026-01-05T16:34:58.567174802-03:00","labels":["cleanup","phase-3","testing"],"dependencies":[{"issue_id":"gendocs-cq002-t4","depends_on_id":"gendocs-cq002-t3","type":"blocks","created_at":"2026-01-05T16:34:58.567925139-03:00","created_by":"daemon"},{"issue_id":"gendocs-cq002-t4","depends_on_id":"gendocs-cq002","type":"parent-child","created_at":"2026-01-05T16:35:03.057319644-03:00","created_by":"daemon"}]}
{"id":"gendocs-cq003","title":"Decompose ScanFiles Function","description":"## Overview\nDecompose the 167-line `ScanFiles` function in `internal/cache/cache.go` into focused helper functions, improving testability and maintainability.\n\n## Current State\n- `ScanFiles` (lines 418-585) is a \"God Function\" with 3 distinct phases:\n  1. **Phase 1 (Walk)**: Filesystem traversal with ignore patterns\n  2. **Phase 2 (Cache)**: Compare metadata against cache for hits/misses\n  3. **Phase 3 (Hash)**: Parallel hashing of cache misses\n- High cyclomatic complexity\n- Difficult to unit test individual phases\n- Mixed concerns: I/O, filtering, caching, concurrency\n\n## Target State\n- `ScanFiles` becomes an orchestrator (~30-40 lines)\n- Three focused helpers:\n  - `collectFiles(repoPath, ignorePatterns)` - filesystem walking + filtering\n  - `resolveCacheHits(files, cache)` - cache comparison\n  - `parallelHashFiles(files, workers)` - concurrent hashing (already exists)\n\n## Files Affected\n- `internal/cache/cache.go` (refactor)\n- `internal/cache/cache_test.go` (add unit tests for helpers)\n\n## Out of Scope\n- Changing file inclusion/exclusion logic\n- Modifying hash algorithm\n- Altering concurrency model","design":"### Proposed Helper Signatures\n\n```go\n// collectFiles walks the repository and returns files matching criteria\nfunc collectFiles(repoPath string, ignorePatterns []string) ([]FileInfo, error) {\n    // filepath.Walk + ignore filtering + binary detection\n}\n\n// resolveCacheHits separates files into cached and needing-hash\nfunc resolveCacheHits(files []FileInfo, cache *AnalysisCache) (cached, needsHash []FileInfo) {\n    // Compare mtime and size against cache entries\n}\n\n// parallelHashFiles already exists - no changes needed\n```\n\n### Refactored ScanFiles\n```go\nfunc (c *AnalysisCache) ScanFiles(repoPath string, opts ScanOptions) (map[string]FileHash, ScanMetrics, error) {\n    files, err := collectFiles(repoPath, opts.IgnorePatterns)\n    if err != nil {\n        return nil, ScanMetrics{}, err\n    }\n    \n    cached, needsHash := resolveCacheHits(files, c)\n    \n    newHashes := parallelHashFiles(needsHash, opts.Workers)\n    \n    return mergeResults(cached, newHashes), computeMetrics(files, cached, newHashes), nil\n}\n```\n\n### Testing Strategy\n1. Test `collectFiles` with fixture directories\n2. Test `resolveCacheHits` with mock cache\n3. Integration test `ScanFiles` for end-to-end behavior","acceptance_criteria":"- [ ] `ScanFiles` reduced to ~30-40 lines orchestration\n- [ ] `collectFiles` helper extracted and tested\n- [ ] `resolveCacheHits` helper extracted and tested\n- [ ] Existing `parallelHashFiles` unchanged\n- [ ] All cache tests pass\n- [ ] File ordering and filtering behavior unchanged\n- [ ] `make test` passes","status":"closed","priority":1,"issue_type":"epic","created_at":"2026-01-05T16:30:36.479122001-03:00","updated_at":"2026-01-05T16:58:38.634413871-03:00","closed_at":"2026-01-05T16:58:38.634413871-03:00","close_reason":"Epic complete: Decomposed ScanFiles from 167 lines to ~30 lines. Extracted collectFiles (file discovery), resolveCacheHits (cache comparison), kept parallelHashFiles (unchanged). All tests pass.","labels":["cache","phase-1","quick-win","refactoring"],"dependencies":[{"issue_id":"gendocs-cq003","depends_on_id":"gendocs-cq005","type":"blocks","created_at":"2026-01-05T16:30:36.479958209-03:00","created_by":"daemon"}]}
{"id":"gendocs-cq003-t1","title":"Add ScanFiles characterization tests with fixture repo","description":"## Objective\nCreate characterization tests that capture the exact behavior of `ScanFiles` before decomposition. Use fixture directories to verify file discovery, filtering, and caching logic.\n\n## What to Test\n1. **File Discovery**\n   - All non-ignored files found\n   - Subdirectories traversed correctly\n   - Symlinks handled appropriately\n\n2. **Ignore Patterns**\n   - `.git` directory excluded\n   - Custom ignore patterns work (*.log, node_modules, etc.)\n   - Nested ignore patterns (foo/**/bar)\n\n3. **Binary Detection**\n   - Binary extensions excluded (.exe, .bin, .png, etc.)\n   - Text files included\n\n4. **Cache Behavior**\n   - Unchanged files use cached hash\n   - Modified files re-hashed (mtime/size change)\n   - New files hashed\n   - Deleted files removed from results\n\n5. **Ordering**\n   - Verify file ordering is deterministic\n   - Document any ordering guarantees\n\n## Test Implementation\n```go\nfunc TestScanFiles_FileDiscovery(t *testing.T) {\n    repoPath := testHelpers.CreateTempRepo(t, map[string]string{\n        \"main.go\":           \"package main\",\n        \"internal/foo.go\":   \"package foo\",\n        \".git/config\":       \"ignored\",\n        \"node_modules/x.js\": \"ignored\",\n    })\n    \n    files, metrics, err := cache.ScanFiles(repoPath, opts)\n    require.NoError(t, err)\n    \n    // Verify expected files found\n    assert.Contains(t, files, \"main.go\")\n    assert.Contains(t, files, \"internal/foo.go\")\n    assert.NotContains(t, files, \".git/config\")\n}\n```\n\n## Files to Modify\n- `internal/cache/cache_test.go`","acceptance_criteria":"- [ ] File discovery tests added\n- [ ] Ignore pattern tests added\n- [ ] Binary detection tests added\n- [ ] Cache hit/miss tests added\n- [ ] Ordering test documenting current behavior\n- [ ] All tests pass with `go test -v ./internal/cache/...`","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-05T16:30:54.851361079-03:00","updated_at":"2026-01-05T16:55:13.543438206-03:00","closed_at":"2026-01-05T16:55:13.543438206-03:00","close_reason":"Comprehensive characterization tests already exist in cache_test.go: TestScanFiles_CacheHit, TestScanFiles_CacheMissDifferentMTime, TestScanFiles_CacheMissDifferentSize, TestScanFiles_NewFiles, TestScanFiles_DeletedFiles, TestScanFiles_MultipleFilesMixedCache, TestScanFiles_NoCache, TestScanFiles_WithIgnorePatterns, TestScanFiles_MetricsNil.","labels":["cache","phase-1","testing"],"dependencies":[{"issue_id":"gendocs-cq003-t1","depends_on_id":"gendocs-cq003","type":"parent-child","created_at":"2026-01-05T16:31:24.728534567-03:00","created_by":"daemon"}]}
{"id":"gendocs-cq003-t2","title":"Extract collectFiles helper function","description":"## Objective\nExtract Phase 1 (filesystem walking) from `ScanFiles` into a dedicated `collectFiles` function.\n\n## Current Code Location\n`internal/cache/cache.go` lines 436-502 (approximately)\n\n## Function Signature\n```go\n// FileInfo contains metadata about a discovered file\ntype FileInfo struct {\n    RelPath string\n    AbsPath string\n    ModTime time.Time\n    Size    int64\n}\n\n// collectFiles walks the repository and returns all files matching the criteria.\n// It filters out ignored patterns and binary files.\nfunc collectFiles(repoPath string, ignorePatterns []string) ([]FileInfo, error)\n```\n\n## Implementation Details\n1. Use `filepath.Walk` for directory traversal\n2. Convert absolute paths to relative paths from repoPath\n3. Apply `shouldIgnore` function for pattern matching\n4. Apply `isBinaryExtension` for binary detection\n5. Collect file metadata (path, mtime, size)\n6. Return sorted slice for deterministic ordering\n\n## Extraction Strategy\n1. Define `FileInfo` struct\n2. Move walking logic to new function\n3. Keep `shouldIgnore` and `isBinaryExtension` as helpers\n4. Update `ScanFiles` to call `collectFiles`\n5. Verify all characterization tests pass\n\n## Files to Modify\n- `internal/cache/cache.go`","acceptance_criteria":"- [ ] `FileInfo` struct defined\n- [ ] `collectFiles` function extracted\n- [ ] Function has clear documentation\n- [ ] Unit tests for `collectFiles` pass\n- [ ] `ScanFiles` uses `collectFiles`\n- [ ] All characterization tests pass\n- [ ] `go test ./internal/cache/...` passes","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-05T16:31:04.828383143-03:00","updated_at":"2026-01-05T16:56:52.632330792-03:00","closed_at":"2026-01-05T16:56:52.632330792-03:00","close_reason":"Extracted collectFiles helper function from ScanFiles. Defined discoveredFile struct. Removed ~50 lines of inline Phase 1 code. All tests pass.","labels":["cache","phase-1","refactoring"],"dependencies":[{"issue_id":"gendocs-cq003-t2","depends_on_id":"gendocs-cq003-t1","type":"blocks","created_at":"2026-01-05T16:31:04.829150842-03:00","created_by":"daemon"},{"issue_id":"gendocs-cq003-t2","depends_on_id":"gendocs-cq003","type":"parent-child","created_at":"2026-01-05T16:31:25.725208412-03:00","created_by":"daemon"}]}
{"id":"gendocs-cq003-t3","title":"Extract resolveCacheHits helper function","description":"## Objective\nExtract Phase 2 (cache comparison) from `ScanFiles` into a dedicated `resolveCacheHits` function.\n\n## Current Code Location\n`internal/cache/cache.go` lines 510-535 (approximately)\n\n## Function Signature\n```go\n// CacheResult contains the outcome of cache resolution\ntype CacheResult struct {\n    CachedFiles  map[string]FileHash  // Files with valid cache entries\n    FilesToHash  []FileInfo           // Files needing fresh hash\n}\n\n// resolveCacheHits compares file metadata against cache entries.\n// Files with matching mtime and size use cached hash.\n// Files with different metadata need re-hashing.\nfunc (c *AnalysisCache) resolveCacheHits(files []FileInfo) CacheResult\n```\n\n## Cache Hit Logic\nA file is a cache hit when:\n- Entry exists in cache for the relative path\n- `mtime` matches cached value\n- `size` matches cached value\n\n## Implementation Details\n1. Iterate over collected files\n2. Check cache for each file's relative path\n3. Compare mtime and size\n4. Categorize as cached or needs-hash\n5. Return structured result\n\n## Files to Modify\n- `internal/cache/cache.go`","acceptance_criteria":"- [ ] `CacheResult` struct defined\n- [ ] `resolveCacheHits` method extracted\n- [ ] Function has clear documentation\n- [ ] Unit tests for `resolveCacheHits` pass\n- [ ] `ScanFiles` uses `resolveCacheHits`\n- [ ] All characterization tests pass\n- [ ] `go test ./internal/cache/...` passes","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-05T16:31:13.010746164-03:00","updated_at":"2026-01-05T16:58:35.00875416-03:00","closed_at":"2026-01-05T16:58:35.00875416-03:00","close_reason":"Extracted resolveCacheHits helper function. Created cacheResolution struct to hold results. Removed ~60 lines of Phase 2 code from ScanFiles. All tests pass.","labels":["cache","phase-1","refactoring"],"dependencies":[{"issue_id":"gendocs-cq003-t3","depends_on_id":"gendocs-cq003-t2","type":"blocks","created_at":"2026-01-05T16:31:13.01150675-03:00","created_by":"daemon"},{"issue_id":"gendocs-cq003-t3","depends_on_id":"gendocs-cq003","type":"parent-child","created_at":"2026-01-05T16:31:26.959602794-03:00","created_by":"daemon"}]}
{"id":"gendocs-cq003-t4","title":"Simplify ScanFiles to orchestrator and cleanup","description":"## Objective\nReduce `ScanFiles` to a clean orchestrator function that coordinates the extracted helpers.\n\n## Target Implementation\n```go\nfunc (c *AnalysisCache) ScanFiles(repoPath string, opts ScanOptions) (map[string]FileHash, ScanMetrics, error) {\n    // Phase 1: Discover files\n    files, err := collectFiles(repoPath, opts.IgnorePatterns)\n    if err != nil {\n        return nil, ScanMetrics{}, fmt.Errorf(\"failed to collect files: %w\", err)\n    }\n    \n    // Phase 2: Resolve cache hits\n    cacheResult := c.resolveCacheHits(files)\n    \n    // Phase 3: Hash uncached files\n    newHashes, hashErr := parallelHashFiles(cacheResult.FilesToHash, opts.Workers)\n    \n    // Merge results\n    result := make(map[string]FileHash, len(files))\n    for path, hash := range cacheResult.CachedFiles {\n        result[path] = hash\n    }\n    for path, hash := range newHashes {\n        result[path] = hash\n    }\n    \n    // Compute metrics\n    metrics := ScanMetrics{\n        TotalFiles:  len(files),\n        CachedFiles: len(cacheResult.CachedFiles),\n        HashedFiles: len(newHashes),\n    }\n    \n    return result, metrics, hashErr\n}\n```\n\n## Cleanup Tasks\n1. Remove inline phase comments (now in function docs)\n2. Remove temporary variables that are no longer needed\n3. Improve error messages\n4. Ensure consistent return value handling\n\n## Files to Modify\n- `internal/cache/cache.go`\n\n## Verification\n- Function reduced to ~30-40 lines\n- All tests pass\n- `make lint` passes","acceptance_criteria":"- [ ] `ScanFiles` reduced to ~30-40 lines\n- [ ] Clear orchestration flow\n- [ ] Error wrapping improved\n- [ ] All characterization tests pass\n- [ ] `make test` passes\n- [ ] `make lint` passes\n- [ ] Code coverage maintained or improved","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-05T16:31:23.443493134-03:00","updated_at":"2026-01-05T16:58:36.472240559-03:00","closed_at":"2026-01-05T16:58:36.472240559-03:00","close_reason":"ScanFiles is now a clean ~30 line orchestrator that calls collectFiles, resolveCacheHits, and parallelHashFiles. Reduced from 167 lines to ~30 lines.","labels":["cache","phase-1","refactoring"],"dependencies":[{"issue_id":"gendocs-cq003-t4","depends_on_id":"gendocs-cq003-t3","type":"blocks","created_at":"2026-01-05T16:31:23.444208805-03:00","created_by":"daemon"},{"issue_id":"gendocs-cq003-t4","depends_on_id":"gendocs-cq003","type":"parent-child","created_at":"2026-01-05T16:31:27.935201583-03:00","created_by":"daemon"}]}
{"id":"gendocs-cq004","title":"Replace TUI Magic Strings with Constants","description":"## Overview\nReplace hardcoded string literals in TUI dashboard sections with typed constants to prevent silent failures from typos.\n\n## Current State\n- 10+ TUI section files use string literals for config key mapping\n- `GetValues()` and `SetValues()` methods use raw strings like `\"provider\"`, `\"api_key\"`\n- Typos cause silent failures (value not saved/loaded)\n- No compile-time safety for key names\n\n## Example of Current Problem\n```go\n// In GetValues\nreturn map[string]any{\"max_workers\": m.maxWorkers.Value()}\n\n// In SetValues - typo would silently fail!\nif v, ok := values[\"max_worker\"].(int); ok {  // Missing 's'!\n    m.maxWorkers.SetValue(v)\n}\n```\n\n## Target State\n```go\nconst (\n    KeyMaxWorkers = \"max_workers\"\n    KeyProvider   = \"provider\"\n    // ...\n)\n\n// In GetValues\nreturn map[string]any{KeyMaxWorkers: m.maxWorkers.Value()}\n\n// In SetValues - typo now causes compile error!\nif v, ok := values[KeyMaxWorkers].(int); ok {\n    m.maxWorkers.SetValue(v)\n}\n```\n\n## Files Affected\n- `internal/tui/dashboard/sections/logging.go`\n- `internal/tui/dashboard/sections/cronjob.go`\n- `internal/tui/dashboard/sections/gitlab.go`\n- `internal/tui/dashboard/sections/gemini.go`\n- `internal/tui/dashboard/sections/retry.go`\n- `internal/tui/dashboard/sections/analysis.go`\n- `internal/tui/dashboard/sections/cache.go`\n- `internal/tui/dashboard/sections/llm.go`\n- `internal/tui/dashboard/sections/ai_rules_llm.go`\n- `internal/tui/dashboard/sections/documenter_llm.go`\n- `internal/config/constants.go` (new file)\n\n## Out of Scope\n- Changing config structure\n- Modifying TUI behavior\n- UI/UX changes","design":"### Constants Organization\n\n**Option A: Single constants file**\n```go\n// internal/config/constants.go\npackage config\n\n// Section key constants\nconst (\n    // LLM Section\n    KeyLLMProvider = \"provider\"\n    KeyLLMModel    = \"model\"\n    KeyLLMAPIKey   = \"api_key\"\n    KeyLLMBaseURL  = \"base_url\"\n    \n    // Cache Section\n    KeyCacheEnabled = \"cache_enabled\"\n    KeyCachePath    = \"cache_path\"\n    KeyCacheMaxSize = \"cache_max_size\"\n    KeyCacheTTL     = \"cache_ttl\"\n    \n    // ...\n)\n```\n\n**Option B: Per-section constants (recommended)**\n```go\n// internal/tui/dashboard/sections/keys.go\npackage sections\n\n// LLM configuration keys\nconst (\n    KeyProvider = \"provider\"\n    KeyModel    = \"model\"\n    KeyAPIKey   = \"api_key\"\n    KeyBaseURL  = \"base_url\"\n)\n\n// Cache configuration keys  \nconst (\n    KeyCacheEnabled = \"cache_enabled\"\n    // ...\n)\n```\n\n### Prefix Handling for LLM Sections\nThe LLM section uses prefixes (`documenter_`, `ai_rules_`). Handle with:\n```go\nfunc (m *LLMSectionModel) GetValues() map[string]any {\n    p := m.descriptor.KeyPrefix\n    return map[string]any{\n        p + KeyProvider: m.provider.Value(),\n        p + KeyModel:    m.model.Value(),\n    }\n}\n```","acceptance_criteria":"- [ ] Constants file created with all config keys\n- [ ] All TUI sections use constants\n- [ ] No raw string literals for config keys\n- [ ] TUI starts without errors\n- [ ] Config saves/loads correctly\n- [ ] `make test` passes\n- [ ] Manual smoke test of TUI config editing","status":"closed","priority":2,"issue_type":"epic","created_at":"2026-01-05T16:32:16.071906053-03:00","updated_at":"2026-01-05T17:08:30.60336722-03:00","closed_at":"2026-01-05T17:08:30.60336722-03:00","close_reason":"Created config_keys.go with 45 constants, migrated all 8 TUI sections","labels":["phase-2","refactoring","tui","type-safety"],"dependencies":[{"issue_id":"gendocs-cq004","depends_on_id":"gendocs-cq001","type":"blocks","created_at":"2026-01-05T16:32:16.072870864-03:00","created_by":"daemon"}]}
{"id":"gendocs-cq004-t1","title":"Create TUI section config keys constants file","description":"## Objective\nCreate a constants file defining all configuration keys used in TUI dashboard sections.\n\n## Inventory of Keys (from analysis)\n**LLM Section**: provider, model, api_key, base_url\n**Cache Section**: cache_enabled, cache_path, cache_max_size, cache_ttl\n**Logging Section**: log_dir, file_level, console_level\n**Retry Section**: max_attempts, multiplier, max_wait_per_attempt, max_total_wait\n**Analysis Section**: exclude_code_structure, exclude_data_flow, max_workers\n**Gemini Section**: use_vertex_ai, project_id, location\n**GitLab Section**: gitlab_api_url, gitlab_user_name, gitlab_user_username\n**Cronjob Section**: working_path, max_days_since_last_commit, group_project_id\n\n## File Structure\n```go\n// internal/tui/dashboard/sections/keys.go\npackage sections\n\n// Common configuration keys used across TUI sections.\n// Using constants prevents typos in GetValues/SetValues mappings.\n\n// LLM configuration keys\nconst (\n    KeyProvider = \"provider\"\n    KeyModel    = \"model\"\n    KeyAPIKey   = \"api_key\"\n    KeyBaseURL  = \"base_url\"\n)\n\n// Cache configuration keys\nconst (\n    KeyCacheEnabled = \"cache_enabled\"\n    KeyCachePath    = \"cache_path\"\n    KeyCacheMaxSize = \"cache_max_size\"\n    KeyCacheTTL     = \"cache_ttl\"\n)\n\n// ... continue for all sections\n```\n\n## Files to Create\n- `internal/tui/dashboard/sections/keys.go`","acceptance_criteria":"- [ ] `keys.go` created in sections package\n- [ ] All known config keys defined\n- [ ] Keys organized by section\n- [ ] Doc comments explaining purpose\n- [ ] File compiles successfully","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-05T16:33:12.217570261-03:00","updated_at":"2026-01-05T17:08:30.614437635-03:00","closed_at":"2026-01-05T17:08:30.614437635-03:00","close_reason":"Created config_keys.go","labels":["phase-2","refactoring","tui"],"dependencies":[{"issue_id":"gendocs-cq004-t1","depends_on_id":"gendocs-cq004","type":"parent-child","created_at":"2026-01-05T16:33:33.326911027-03:00","created_by":"daemon"}]}
{"id":"gendocs-cq004-t2","title":"Migrate LLM and Cache sections to use constants","description":"## Objective\nMigrate the LLM and Cache TUI sections to use the new constants, serving as a pattern for other sections.\n\n## Files to Modify\n- `internal/tui/dashboard/sections/llm.go`\n- `internal/tui/dashboard/sections/cache.go`\n- `internal/tui/dashboard/sections/ai_rules_llm.go`\n- `internal/tui/dashboard/sections/documenter_llm.go`\n\n## LLM Section Changes\n```go\n// Before\nfunc (m *LLMSectionModel) GetValues() map[string]any {\n    p := m.descriptor.KeyPrefix\n    return map[string]any{\n        p + \"provider\": m.provider.Value(),\n        p + \"model\":    m.model.Value(),\n    }\n}\n\n// After\nfunc (m *LLMSectionModel) GetValues() map[string]any {\n    p := m.descriptor.KeyPrefix\n    return map[string]any{\n        p + KeyProvider: m.provider.Value(),\n        p + KeyModel:    m.model.Value(),\n    }\n}\n```\n\n## Cache Section Changes\n```go\n// Before\nreturn map[string]any{\n    \"cache_enabled\": m.enabled.Value(),\n}\n\n// After\nreturn map[string]any{\n    KeyCacheEnabled: m.enabled.Value(),\n}\n```\n\n## Verification\n- TUI starts without errors\n- Config values load correctly\n- Config values save correctly","acceptance_criteria":"- [ ] `llm.go` uses constants for all keys\n- [ ] `cache.go` uses constants for all keys\n- [ ] `ai_rules_llm.go` uses constants\n- [ ] `documenter_llm.go` uses constants\n- [ ] TUI smoke test passes\n- [ ] `go test ./internal/tui/...` passes","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-05T16:33:22.961004281-03:00","updated_at":"2026-01-05T17:08:30.623657335-03:00","closed_at":"2026-01-05T17:08:30.623657335-03:00","close_reason":"Migrated LLM and Cache sections","labels":["phase-2","refactoring","tui"],"dependencies":[{"issue_id":"gendocs-cq004-t2","depends_on_id":"gendocs-cq004-t1","type":"blocks","created_at":"2026-01-05T16:33:22.961767993-03:00","created_by":"daemon"},{"issue_id":"gendocs-cq004-t2","depends_on_id":"gendocs-cq004","type":"parent-child","created_at":"2026-01-05T16:33:34.405628079-03:00","created_by":"daemon"}]}
{"id":"gendocs-cq004-t3","title":"Migrate remaining TUI sections to use constants","description":"## Objective\nComplete the migration by updating all remaining TUI sections to use constants.\n\n## Files to Modify\n- `internal/tui/dashboard/sections/logging.go`\n- `internal/tui/dashboard/sections/cronjob.go`\n- `internal/tui/dashboard/sections/gitlab.go`\n- `internal/tui/dashboard/sections/gemini.go`\n- `internal/tui/dashboard/sections/retry.go`\n- `internal/tui/dashboard/sections/analysis.go`\n\n## Pattern to Apply\nSame as LLM/Cache sections:\n1. Replace string literals in `GetValues()` with constants\n2. Replace string literals in `SetValues()` with constants\n3. Verify both methods use same constant (prevents get/set mismatch)\n\n## Verification Checklist\nFor each file:\n- [ ] `GetValues()` uses constants\n- [ ] `SetValues()` uses constants\n- [ ] No string literals for config keys remain\n\n## Final Verification\n- Run grep to find remaining magic strings: `grep -n '\"[a-z_]*\"' internal/tui/dashboard/sections/*.go`\n- TUI smoke test all sections\n- `make test` passes","acceptance_criteria":"- [ ] All 6 section files updated\n- [ ] No string literals for config keys\n- [ ] grep verification passes (no magic strings)\n- [ ] TUI smoke test all sections\n- [ ] `make test` passes\n- [ ] `make lint` passes","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-05T16:33:31.824409578-03:00","updated_at":"2026-01-05T17:08:30.632744633-03:00","closed_at":"2026-01-05T17:08:30.632744633-03:00","close_reason":"Migrated all remaining sections","labels":["phase-2","refactoring","tui"],"dependencies":[{"issue_id":"gendocs-cq004-t3","depends_on_id":"gendocs-cq004-t2","type":"blocks","created_at":"2026-01-05T16:33:31.825138234-03:00","created_by":"daemon"},{"issue_id":"gendocs-cq004-t3","depends_on_id":"gendocs-cq004","type":"parent-child","created_at":"2026-01-05T16:33:35.552820254-03:00","created_by":"daemon"}]}
{"id":"gendocs-cq005","title":"Consolidate LLM Client HTTP Boilerplate","description":"## Overview\nImplement the missing `doHTTPRequest` method in `BaseLLMClient` to consolidate duplicated HTTP boilerplate across OpenAI, Anthropic, and Gemini clients.\n\n## Current State\n- `internal/llm/client.go` contains `BaseLLMClient` struct with only `*RetryClient` reference\n- A `doHTTPRequest` method is documented but NOT implemented (stub exists)\n- Each provider client manually implements:\n  - JSON marshalling of request payload\n  - HTTP request creation with `http.NewRequestWithContext`\n  - Header setting (Content-Type, Auth)\n  - Request execution via `retryClient.Do()`\n  - Status code checking\n  - Error body reading and wrapping\n\n## Target State\n- `BaseLLMClient.doHTTPRequest()` handles the common HTTP lifecycle\n- Provider clients only handle:\n  - Payload conversion (`convertRequest`)\n  - Response parsing (`parseStreamingResponse`)\n  - Provider-specific headers (API key format)\n\n## Files Affected\n- `internal/llm/client.go` (add method)\n- `internal/llm/openai.go` (refactor)\n- `internal/llm/anthropic.go` (refactor)\n- `internal/llm/gemini.go` (refactor)\n\n## Out of Scope\n- Changing response parsing logic\n- Modifying streaming behavior\n- Altering retry policies","design":"### Method Signature\n```go\nfunc (b *BaseLLMClient) doHTTPRequest(\n    ctx context.Context,\n    method string,\n    url string,\n    headers map[string]string,\n    payload interface{},\n) (*http.Response, error)\n```\n\n### Implementation Flow\n1. Marshal payload to JSON\n2. Create request with context\n3. Set default headers (Content-Type: application/json)\n4. Apply custom headers\n5. Execute via retryClient.Do()\n6. Check for non-2xx status\n7. Return response or wrapped error\n\n### Provider-Specific Headers\n- **OpenAI**: `Authorization: Bearer {key}`\n- **Anthropic**: `x-api-key: {key}`, `anthropic-version: {version}`\n- **Gemini**: URL query param `?key={key}`\n\n### Error Wrapping\n```go\nif resp.StatusCode \u003e= 400 {\n    body, _ := io.ReadAll(resp.Body)\n    return nil, fmt.Errorf(\"LLM API error (status %d): %s\", resp.StatusCode, body)\n}\n```","acceptance_criteria":"- [ ] `BaseLLMClient.doHTTPRequest` implemented\n- [ ] OpenAI client uses shared method\n- [ ] Anthropic client uses shared method\n- [ ] Gemini client uses shared method\n- [ ] Error handling consistent across providers\n- [ ] All LLM tests pass with race detection\n- [ ] ~50% reduction in GenerateCompletion method size","status":"closed","priority":1,"issue_type":"epic","created_at":"2026-01-05T16:29:09.651176251-03:00","updated_at":"2026-01-05T16:53:30.530423814-03:00","closed_at":"2026-01-05T16:53:30.530423814-03:00","close_reason":"Epic complete: Implemented doHTTPRequest in BaseLLMClient and migrated OpenAI, Anthropic, and Gemini clients to use it. Consolidated ~45 lines of duplicated HTTP boilerplate into a single method. All tests pass with race detection.","labels":["llm","phase-1","quick-win","refactoring"],"dependencies":[{"issue_id":"gendocs-cq005","depends_on_id":"gendocs-cq006","type":"blocks","created_at":"2026-01-05T16:29:09.652687803-03:00","created_by":"daemon"}]}
{"id":"gendocs-cq005-t1","title":"Add LLM client behavior characterization tests","description":"## Objective\nCreate characterization tests that capture the exact HTTP behavior of one LLM client (OpenAI recommended) before refactoring. These tests validate that the consolidated `doHTTPRequest` behaves identically.\n\n## What to Test\n1. **Request Construction**\n   - Correct URL formation\n   - Proper JSON marshalling\n   - Content-Type header present\n   - Authorization header format\n\n2. **Response Handling**\n   - 200 OK with valid JSON body\n   - 200 OK with streaming SSE response\n   - 401 Unauthorized (missing/invalid API key)\n   - 429 Rate Limited\n   - 500 Internal Server Error\n   - Timeout handling\n\n3. **Error Wrapping**\n   - Error messages include status code\n   - Error messages include response body (for debugging)\n   - Context cancellation propagated\n\n## Test Implementation\n```go\nfunc TestOpenAIClient_HTTPBehavior(t *testing.T) {\n    tests := []struct {\n        name           string\n        serverStatus   int\n        serverBody     string\n        wantErr        bool\n        wantErrContain string\n    }{\n        {\"success\", 200, validSSEResponse, false, \"\"},\n        {\"unauthorized\", 401, `{\"error\":\"invalid key\"}`, true, \"401\"},\n        {\"rate_limited\", 429, `{\"error\":\"rate limit\"}`, true, \"429\"},\n        {\"server_error\", 500, `{\"error\":\"internal\"}`, true, \"500\"},\n    }\n    // ...\n}\n```\n\n## Files to Create/Modify\n- `internal/llm/openai_test.go` (add characterization tests)\n- Optionally: `internal/llm/http_test.go` for shared test helpers","acceptance_criteria":"- [ ] Request construction tests added\n- [ ] Response handling tests for all status codes\n- [ ] Error message format verified\n- [ ] Tests pass with `go test -race ./internal/llm/...`\n- [ ] Coverage increased for HTTP handling paths","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-05T16:29:33.423917103-03:00","updated_at":"2026-01-05T16:50:00.857024765-03:00","closed_at":"2026-01-05T16:50:00.857024765-03:00","close_reason":"Characterization tests already exist in openai_test.go covering: success/streaming, tool calls, 401/429 errors, context cancellation, incomplete streams, malformed chunks. No additional tests needed.","labels":["llm","phase-1","testing"],"dependencies":[{"issue_id":"gendocs-cq005-t1","depends_on_id":"gendocs-cq005","type":"parent-child","created_at":"2026-01-05T16:30:07.140777713-03:00","created_by":"daemon"}]}
{"id":"gendocs-cq005-t2","title":"Implement BaseLLMClient.doHTTPRequest method","description":"## Objective\nImplement the `doHTTPRequest` method in `BaseLLMClient` that handles the common HTTP lifecycle for all LLM providers.\n\n## Implementation Location\n`internal/llm/client.go`\n\n## Method Signature\n```go\n// doHTTPRequest performs an HTTP request with JSON payload and returns the response.\n// It handles marshalling, header setting, and basic error checking.\n// The caller is responsible for closing the response body.\nfunc (b *BaseLLMClient) doHTTPRequest(\n    ctx context.Context,\n    method string,\n    url string,\n    headers map[string]string,\n    payload interface{},\n) (*http.Response, error)\n```\n\n## Implementation Steps\n1. Marshal payload to JSON using `json.Marshal`\n2. Create request: `http.NewRequestWithContext(ctx, method, url, bytes.NewReader(jsonData))`\n3. Set default header: `Content-Type: application/json`\n4. Apply custom headers from map\n5. Execute request via `b.retryClient.Do(req)`\n6. Return response (caller handles body parsing)\n\n## Important Notes\n- Do NOT close response body here - caller needs it for streaming\n- Do NOT check status codes here - let caller handle provider-specific errors\n- Keep method minimal and focused on HTTP mechanics only\n\n## Error Handling\nOnly wrap errors from:\n- JSON marshalling failures\n- Request creation failures\n- Network/transport errors\n\n## Files to Modify\n- `internal/llm/client.go`","acceptance_criteria":"- [ ] Method implemented with documented signature\n- [ ] JSON marshalling error handling\n- [ ] Request creation error handling\n- [ ] Custom headers applied correctly\n- [ ] Response body NOT closed (caller responsibility)\n- [ ] Unit tests for the method pass\n- [ ] `go test ./internal/llm/...` passes","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-05T16:29:40.239757739-03:00","updated_at":"2026-01-05T16:51:08.26180853-03:00","closed_at":"2026-01-05T16:51:08.26180853-03:00","close_reason":"Implemented BaseLLMClient.doHTTPRequest method in client.go. Handles JSON marshaling, request creation, header setting, and retry execution. Tests pass with race detection.","labels":["llm","phase-1","refactoring"],"dependencies":[{"issue_id":"gendocs-cq005-t2","depends_on_id":"gendocs-cq005-t1","type":"blocks","created_at":"2026-01-05T16:29:40.240522172-03:00","created_by":"daemon"},{"issue_id":"gendocs-cq005-t2","depends_on_id":"gendocs-cq005","type":"parent-child","created_at":"2026-01-05T16:30:09.305796479-03:00","created_by":"daemon"}]}
{"id":"gendocs-cq005-t3","title":"Migrate OpenAIClient to use doHTTPRequest","description":"## Objective\nRefactor `OpenAIClient.GenerateCompletion` to use the new `BaseLLMClient.doHTTPRequest` method, removing duplicated HTTP boilerplate.\n\n## Current Implementation (lines to remove)\n```go\nfunc (c *OpenAIClient) GenerateCompletion(ctx context.Context, req CompletionRequest) (CompletionResponse, error) {\n    // Convert request to OpenAI format\n    openaiReq := c.convertRequest(req)\n    \n    // REMOVE: Manual JSON marshalling\n    jsonData, err := json.Marshal(openaiReq)\n    if err != nil {\n        return CompletionResponse{}, fmt.Errorf(\"failed to marshal request: %w\", err)\n    }\n    \n    // REMOVE: Manual request creation\n    httpReq, err := http.NewRequestWithContext(ctx, \"POST\", c.config.BaseURL+\"/chat/completions\", bytes.NewReader(jsonData))\n    if err != nil {\n        return CompletionResponse{}, fmt.Errorf(\"failed to create request: %w\", err)\n    }\n    \n    // REMOVE: Manual header setting\n    httpReq.Header.Set(\"Content-Type\", \"application/json\")\n    httpReq.Header.Set(\"Authorization\", \"Bearer \"+c.config.APIKey)\n    \n    // REMOVE: Manual request execution\n    resp, err := c.retryClient.Do(httpReq)\n    // ...\n}\n```\n\n## Target Implementation\n```go\nfunc (c *OpenAIClient) GenerateCompletion(ctx context.Context, req CompletionRequest) (CompletionResponse, error) {\n    openaiReq := c.convertRequest(req)\n    \n    headers := map[string]string{\n        \"Authorization\": \"Bearer \" + c.config.APIKey,\n    }\n    \n    resp, err := c.doHTTPRequest(ctx, \"POST\", c.config.BaseURL+\"/chat/completions\", headers, openaiReq)\n    if err != nil {\n        return CompletionResponse{}, err\n    }\n    defer resp.Body.Close()\n    \n    // Keep: Status checking and response parsing\n    // ...\n}\n```\n\n## Files to Modify\n- `internal/llm/openai.go`\n\n## Verification\n- All OpenAI tests pass\n- Characterization tests confirm identical behavior\n- No changes to public API","acceptance_criteria":"- [ ] `GenerateCompletion` uses `doHTTPRequest`\n- [ ] ~20-30 lines of boilerplate removed\n- [ ] All OpenAI tests pass\n- [ ] Characterization tests unchanged\n- [ ] `go test -race ./internal/llm/...` passes","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-05T16:29:53.923028528-03:00","updated_at":"2026-01-05T16:52:07.629210682-03:00","closed_at":"2026-01-05T16:52:07.629210682-03:00","close_reason":"Migrated OpenAIClient.GenerateCompletion to use doHTTPRequest. Removed ~15 lines of boilerplate. All tests pass with race detection.","labels":["llm","phase-1","refactoring"],"dependencies":[{"issue_id":"gendocs-cq005-t3","depends_on_id":"gendocs-cq005-t2","type":"blocks","created_at":"2026-01-05T16:29:53.923798009-03:00","created_by":"daemon"},{"issue_id":"gendocs-cq005-t3","depends_on_id":"gendocs-cq005","type":"parent-child","created_at":"2026-01-05T16:30:10.594135186-03:00","created_by":"daemon"}]}
{"id":"gendocs-cq005-t4","title":"Migrate AnthropicClient and GeminiClient to use doHTTPRequest","description":"## Objective\nApply the same refactoring pattern from OpenAIClient to Anthropic and Gemini clients.\n\n## AnthropicClient Changes\n```go\n// Before\nhttpReq.Header.Set(\"x-api-key\", c.config.APIKey)\nhttpReq.Header.Set(\"anthropic-version\", \"2023-06-01\")\n\n// After\nheaders := map[string]string{\n    \"x-api-key\":         c.config.APIKey,\n    \"anthropic-version\": \"2023-06-01\",\n}\nresp, err := c.doHTTPRequest(ctx, \"POST\", url, headers, anthropicReq)\n```\n\n## GeminiClient Changes\nNote: Gemini uses URL query params for API key, not headers.\n```go\n// Before\nurl := c.config.BaseURL + \"/models/\" + c.config.Model + \":streamGenerateContent?key=\" + c.config.APIKey\n\n// After (unchanged - key in URL)\nurl := c.buildURL()\nresp, err := c.doHTTPRequest(ctx, \"POST\", url, nil, geminiReq)\n```\n\n## Files to Modify\n- `internal/llm/anthropic.go`\n- `internal/llm/gemini.go`\n\n## Testing Strategy\n1. Run Anthropic tests after migration\n2. Run Gemini tests after migration\n3. Run full LLM test suite with race detection","acceptance_criteria":"- [ ] `AnthropicClient.GenerateCompletion` uses `doHTTPRequest`\n- [ ] `GeminiClient.GenerateCompletion` uses `doHTTPRequest`\n- [ ] All provider tests pass individually\n- [ ] Full LLM test suite passes\n- [ ] `go test -race ./internal/llm/...` passes\n- [ ] Consistent error handling across all providers","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-05T16:30:05.184563657-03:00","updated_at":"2026-01-05T16:53:28.08342651-03:00","closed_at":"2026-01-05T16:53:28.08342651-03:00","close_reason":"Migrated AnthropicClient and GeminiClient to use doHTTPRequest. Removed bytes import from all three provider files. All tests pass with race detection.","labels":["llm","phase-1","refactoring"],"dependencies":[{"issue_id":"gendocs-cq005-t4","depends_on_id":"gendocs-cq005-t3","type":"blocks","created_at":"2026-01-05T16:30:05.185308702-03:00","created_by":"daemon"},{"issue_id":"gendocs-cq005-t4","depends_on_id":"gendocs-cq005","type":"parent-child","created_at":"2026-01-05T16:30:11.380654215-03:00","created_by":"daemon"}]}
{"id":"gendocs-cq006","title":"Migrate Config Loader to Viper Unmarshal","description":"## Overview\nReplace manual config extraction helpers (`getString`, `getInt`, `getBool`, `getFloat64`) with Viper's native `Unmarshal` capability. The structs in `models.go` already have `mapstructure` tags, making this migration straightforward.\n\n## Current State\n- `internal/config/loader.go` uses ~120 lines of manual helper functions (lines 285-401)\n- Each config field is manually extracted: `cfg.LLM.Provider = getString(configMap, \"llm.provider\", ...)`\n- Environment variable handling duplicates Viper's built-in `BindEnv` functionality\n- Adding new config fields requires boilerplate in multiple places\n\n## Target State\n- Config structs populated directly via `v.UnmarshalKey(\"analyzer\", \u0026cfg)`\n- Environment bindings centralized using `v.BindEnv()`\n- Helper functions deleted\n- ~100-120 lines of code removed\n\n## Files Affected\n- `internal/config/loader.go` (primary)\n- `internal/config/loader_test.go` (test updates)\n\n## Out of Scope\n- Changing config struct definitions\n- Modifying CLI flag handling\n- Changing config file format","design":"### Implementation Strategy\n\n1. **Characterization Tests First**: Add tests that capture current behavior for edge cases (nil values, type coercion, env override precedence)\n\n2. **Parallel Implementation**: Create new `loadWithUnmarshal()` alongside existing code, compare outputs\n\n3. **Incremental Migration**: \n   - Migrate `LoadAnalyzerConfig` first\n   - Then `LoadDocumenterConfig`\n   - Finally `LoadAIRulesConfig`\n\n4. **Cleanup Phase**: Remove old helpers only after all loaders migrated\n\n### Technical Approach\n```go\n// Before\ncfg.LLM.Provider = getString(configMap, \"llm.provider\", defaults.LLM.Provider)\n\n// After  \nv.SetDefault(\"analyzer.llm.provider\", defaults.LLM.Provider)\nv.BindEnv(\"analyzer.llm.provider\", \"GENDOCS_LLM_PROVIDER\")\nv.UnmarshalKey(\"analyzer\", \u0026cfg)\n```\n\n### Risk Mitigation\n- Type coercion differences between manual parsing and mapstructure\n- Viper's handling of nested structs vs flat maps\n- Test for nil/empty string distinction","acceptance_criteria":"- [ ] All manual helper functions (`getString`, `getInt`, `getBool`, `getFloat64`, `getEnvOrDefault`, etc.) removed\n- [ ] Config loading uses `v.Unmarshal` or `v.UnmarshalKey`\n- [ ] Environment variable precedence unchanged (CLI \u003e project config \u003e user config \u003e env \u003e defaults)\n- [ ] All existing loader tests pass\n- [ ] `make test` passes\n- [ ] No runtime behavior changes in config loading","status":"closed","priority":1,"issue_type":"epic","created_at":"2026-01-05T16:27:44.664226925-03:00","updated_at":"2026-01-05T16:48:34.86118877-03:00","closed_at":"2026-01-05T16:48:34.86118877-03:00","close_reason":"Epic complete: Migrated LoadAnalyzerConfig, LoadDocumenterConfig, LoadAIRulesConfig to use mapstructure.Decode with Viper. Deleted unused manual helpers. Net code reduction ~80 lines while improving maintainability.","labels":["config","phase-1","quick-win","refactoring"]}
{"id":"gendocs-cq006-t1","title":"Add config loader characterization tests","description":"## Objective\nCreate comprehensive characterization tests that capture the exact current behavior of config loading before any refactoring begins. These tests will serve as a safety net during the migration.\n\n## What to Test\n1. **Default Values**: Verify all default values are correctly applied when no config provided\n2. **Environment Variable Override**: Test that env vars override config file values\n3. **CLI Flag Override**: Test that CLI flags override both env vars and config\n4. **Type Coercion**: Test edge cases like string \"true\"  bool, string \"123\"  int\n5. **Nil vs Empty**: Distinguish between missing keys and empty string values\n6. **Nested Structs**: Verify nested config (LLM, Cache, Retry) loads correctly\n\n## Test Cases to Add\n```go\nfunc TestConfigLoader_Precedence(t *testing.T) {\n    // CLI \u003e env \u003e project config \u003e user config \u003e defaults\n}\n\nfunc TestConfigLoader_TypeCoercion(t *testing.T) {\n    // String numbers, string bools, nil handling\n}\n\nfunc TestConfigLoader_NestedStructs(t *testing.T) {\n    // LLMConfig, CacheConfig, RetryConfig\n}\n\nfunc TestConfigLoader_EnvironmentBindings(t *testing.T) {\n    // All GENDOCS_* env vars\n}\n```\n\n## Files to Modify\n- `internal/config/loader_test.go`\n\n## Success Criteria\n- All tests pass with current implementation\n- Tests cover edge cases that might break during migration\n- Test output can be used as golden reference","acceptance_criteria":"- [ ] Precedence test added (CLI \u003e env \u003e config \u003e defaults)\n- [ ] Type coercion edge cases covered\n- [ ] Nested struct loading verified\n- [ ] Environment variable bindings tested\n- [ ] All tests pass with `go test -v ./internal/config/...`\n- [ ] Test coverage for loader.go increased","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-05T16:28:01.37011889-03:00","updated_at":"2026-01-05T16:41:51.997311823-03:00","closed_at":"2026-01-05T16:41:51.997311823-03:00","close_reason":"Added comprehensive characterization tests for all config helpers (getString, getInt, getBool, getFloat64, getEnvOrDefault, getEnvWithFallback, getEnvIntOrDefault, getEnvFloatOrDefault). All tests pass.","labels":["config","phase-1","testing"],"dependencies":[{"issue_id":"gendocs-cq006-t1","depends_on_id":"gendocs-cq006","type":"parent-child","created_at":"2026-01-05T16:28:38.880458496-03:00","created_by":"daemon"}]}
{"id":"gendocs-cq006-t2","title":"Implement Viper Unmarshal for LoadAnalyzerConfig","description":"## Objective\nReplace manual field extraction in `LoadAnalyzerConfig` with Viper's `UnmarshalKey` method.\n\n## Current Implementation (to replace)\n```go\nfunc LoadAnalyzerConfig(v *viper.Viper, overrides ConfigOverrides) (*AnalyzerConfig, error) {\n    configMap := v.AllSettings()\n    cfg := \u0026AnalyzerConfig{}\n    cfg.RepoPath = getString(configMap, \"analyzer.repo_path\", \"\")\n    cfg.LLM.Provider = getString(configMap, \"analyzer.llm.provider\", \"openai\")\n    // ... 50+ more lines of manual extraction\n}\n```\n\n## Target Implementation\n```go\nfunc LoadAnalyzerConfig(v *viper.Viper, overrides ConfigOverrides) (*AnalyzerConfig, error) {\n    // Set defaults\n    setAnalyzerDefaults(v)\n    \n    // Bind environment variables\n    bindAnalyzerEnvVars(v)\n    \n    // Apply overrides\n    applyAnalyzerOverrides(v, overrides)\n    \n    // Unmarshal directly into struct\n    cfg := \u0026AnalyzerConfig{}\n    if err := v.UnmarshalKey(\"analyzer\", cfg); err != nil {\n        return nil, fmt.Errorf(\"failed to unmarshal analyzer config: %w\", err)\n    }\n    \n    return cfg, nil\n}\n```\n\n## Implementation Steps\n1. Create `setAnalyzerDefaults(v *viper.Viper)` helper\n2. Create `bindAnalyzerEnvVars(v *viper.Viper)` helper  \n3. Create `applyAnalyzerOverrides(v *viper.Viper, o ConfigOverrides)` helper\n4. Replace manual extraction with `v.UnmarshalKey`\n5. Verify all characterization tests pass\n\n## Files to Modify\n- `internal/config/loader.go`\n\n## Risk Points\n- Mapstructure tag naming must match config keys exactly\n- Pointer vs value struct fields may behave differently\n- Custom types may need decoder hooks","acceptance_criteria":"- [ ] `LoadAnalyzerConfig` uses `v.UnmarshalKey`\n- [ ] Defaults set via `v.SetDefault`\n- [ ] Env vars bound via `v.BindEnv`\n- [ ] All characterization tests pass\n- [ ] No behavior change detected\n- [ ] `go test ./internal/config/...` passes","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-05T16:28:14.09938466-03:00","updated_at":"2026-01-05T16:44:42.424524074-03:00","closed_at":"2026-01-05T16:44:42.424524074-03:00","close_reason":"Implemented Viper Unmarshal for LoadAnalyzerConfig using mapstructure.Decode with Squash for embedded structs. Created applyAnalyzerDefaults and applyAnalyzerEnvOverrides helpers. All tests pass.","labels":["config","phase-1","refactoring"],"dependencies":[{"issue_id":"gendocs-cq006-t2","depends_on_id":"gendocs-cq006-t1","type":"blocks","created_at":"2026-01-05T16:28:14.10015342-03:00","created_by":"daemon"},{"issue_id":"gendocs-cq006-t2","depends_on_id":"gendocs-cq006","type":"parent-child","created_at":"2026-01-05T16:28:40.166645713-03:00","created_by":"daemon"}]}
{"id":"gendocs-cq006-t3","title":"Migrate LoadDocumenterConfig and LoadAIRulesConfig to Viper Unmarshal","description":"## Objective\nApply the same Viper Unmarshal pattern to the remaining config loaders after validating the approach with LoadAnalyzerConfig.\n\n## Functions to Migrate\n1. `LoadDocumenterConfig(v *viper.Viper, overrides ConfigOverrides)`\n2. `LoadAIRulesConfig(v *viper.Viper, overrides ConfigOverrides)`\n\n## Pattern to Apply\nSame as LoadAnalyzerConfig:\n1. Set defaults via `v.SetDefault`\n2. Bind env vars via `v.BindEnv`\n3. Apply overrides\n4. Unmarshal with `v.UnmarshalKey`\n\n## Consideration: Code Reuse\nConsider creating a generic helper:\n```go\nfunc loadConfig[T any](v *viper.Viper, key string, defaults T, envBindings map[string]string) (*T, error) {\n    // Set defaults from struct\n    // Bind env vars\n    // Unmarshal\n}\n```\n\n## Files to Modify\n- `internal/config/loader.go`\n\n## Testing\n- Run existing tests for each loader\n- Verify precedence behavior unchanged","acceptance_criteria":"- [ ] `LoadDocumenterConfig` uses Viper Unmarshal\n- [ ] `LoadAIRulesConfig` uses Viper Unmarshal\n- [ ] All existing tests pass\n- [ ] `make test-short` passes\n- [ ] Config precedence unchanged","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-05T16:28:22.452751974-03:00","updated_at":"2026-01-05T16:46:33.570911244-03:00","closed_at":"2026-01-05T16:46:33.570911244-03:00","close_reason":"Migrated LoadDocumenterConfig, LoadAIRulesConfig, and LoadCheckConfig to use mapstructure.Decode. Added applyDefaults and applyEnvOverrides helpers for each. All tests pass.","labels":["config","phase-1","refactoring"],"dependencies":[{"issue_id":"gendocs-cq006-t3","depends_on_id":"gendocs-cq006-t2","type":"blocks","created_at":"2026-01-05T16:28:22.453665818-03:00","created_by":"daemon"},{"issue_id":"gendocs-cq006-t3","depends_on_id":"gendocs-cq006","type":"parent-child","created_at":"2026-01-05T16:28:41.45795503-03:00","created_by":"daemon"}]}
{"id":"gendocs-cq006-t4","title":"Delete manual config helper functions","description":"## Objective\nRemove all manual helper functions that are no longer needed after migrating to Viper Unmarshal.\n\n## Functions to Delete\nFrom `internal/config/loader.go` (lines 285-401):\n- `getString(m map[string]interface{}, key string, defaultVal string) string`\n- `getInt(m map[string]interface{}, key string, defaultVal int) int`\n- `getBool(m map[string]interface{}, key string, defaultVal bool) bool`\n- `getFloat64(m map[string]interface{}, key string, defaultVal float64) float64`\n- `getEnvOrDefault(envKey string, defaultVal string) string`\n- `getEnvWithFallback(primary string, fallback string, defaultVal string) string`\n- `getEnvIntOrDefault(envKey string, defaultVal int) int`\n- `getEnvFloatOrDefault(envKey string, defaultVal float64) float64`\n\n## Verification Steps\n1. Search codebase for any remaining usages: `grep -r \"getString\\|getInt\\|getBool\" internal/`\n2. Ensure no compilation errors\n3. Run full test suite\n\n## Expected Outcome\n- ~120 lines of code removed\n- No dead code remaining\n- Cleaner, more maintainable config loader\n\n## Files to Modify\n- `internal/config/loader.go`","acceptance_criteria":"- [ ] All 8 helper functions deleted\n- [ ] No remaining usages in codebase\n- [ ] Code compiles successfully\n- [ ] `make test` passes\n- [ ] `make lint` passes\n- [ ] ~100-120 lines removed from loader.go","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-05T16:28:31.97691497-03:00","updated_at":"2026-01-05T16:48:32.513260292-03:00","closed_at":"2026-01-05T16:48:32.513260292-03:00","close_reason":"Deleted unused manual config helper functions (getString, getInt, getBool, getFloat64). Env helpers retained as still in use. ~80 lines of code removed. All tests pass.","labels":["cleanup","config","phase-1"],"dependencies":[{"issue_id":"gendocs-cq006-t4","depends_on_id":"gendocs-cq006-t3","type":"blocks","created_at":"2026-01-05T16:28:31.977694591-03:00","created_by":"daemon"},{"issue_id":"gendocs-cq006-t4","depends_on_id":"gendocs-cq006","type":"parent-child","created_at":"2026-01-05T16:28:42.531303264-03:00","created_by":"daemon"}]}
{"id":"gendocs-fn3","title":"Create test fixture with all 50+ config fields","description":"Create internal/config/testdata/full_config.yaml with all GlobalConfig fields for round-trip testing","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T16:47:47.552057272-03:00","created_by":"diogo","updated_at":"2025-12-29T16:49:42.767345632-03:00","closed_at":"2025-12-29T16:49:42.767345632-03:00","close_reason":"Closed","labels":["config","test"]}
{"id":"gendocs-ggi","title":"Implement LLM section tests","description":"Test LLMSectionModel: field navigation, validation, GetValues, SetValues, IsDirty","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T16:47:52.611417223-03:00","created_by":"diogo","updated_at":"2025-12-29T16:56:35.95550361-03:00","closed_at":"2025-12-29T16:56:35.95550361-03:00","close_reason":"Closed","labels":["test","tui"]}
{"id":"gendocs-l5p","title":"Implement TUI integration tests","description":"Test complete flows: load config, modify fields, save, reload; scope switching; keyboard nav","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T16:47:53.549512157-03:00","created_by":"diogo","updated_at":"2025-12-29T16:58:08.338067657-03:00","closed_at":"2025-12-29T16:58:08.338067657-03:00","close_reason":"Closed","labels":["test","tui"],"dependencies":[{"issue_id":"gendocs-l5p","depends_on_id":"gendocs-8ek","type":"blocks","created_at":"2025-12-29T16:48:17.622862693-03:00","created_by":"daemon"},{"issue_id":"gendocs-l5p","depends_on_id":"gendocs-1pa","type":"blocks","created_at":"2025-12-29T16:48:17.627385838-03:00","created_by":"daemon"}]}
{"id":"gendocs-nir","title":"Update cmd/config.go to register new documenter_llm and ai_rules_llm sections","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-30T10:45:15.607085899-03:00","created_by":"diogo","updated_at":"2025-12-30T10:48:23.880752186-03:00","closed_at":"2025-12-30T10:48:23.880752186-03:00","close_reason":"Closed","dependencies":[{"issue_id":"gendocs-nir","depends_on_id":"gendocs-rss","type":"blocks","created_at":"2025-12-30T10:45:28.194690332-03:00","created_by":"daemon"},{"issue_id":"gendocs-nir","depends_on_id":"gendocs-wt1","type":"blocks","created_at":"2025-12-30T10:45:28.199005945-03:00","created_by":"daemon"}]}
{"id":"gendocs-p54","title":"Update sidebar.go to add Documenter LLM and AI Rules LLM navigation items","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-30T10:45:14.925055099-03:00","created_by":"diogo","updated_at":"2025-12-30T10:48:00.707013829-03:00","closed_at":"2025-12-30T10:48:00.707013829-03:00","close_reason":"Closed","dependencies":[{"issue_id":"gendocs-p54","depends_on_id":"gendocs-rss","type":"blocks","created_at":"2025-12-30T10:45:28.183729015-03:00","created_by":"daemon"},{"issue_id":"gendocs-p54","depends_on_id":"gendocs-wt1","type":"blocks","created_at":"2025-12-30T10:45:28.190160233-03:00","created_by":"daemon"}]}
{"id":"gendocs-rss","title":"Create documenter_llm.go thin wrapper section for README generation LLM config","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-30T10:45:13.531105754-03:00","created_by":"diogo","updated_at":"2025-12-30T10:47:37.217490707-03:00","closed_at":"2025-12-30T10:47:37.217490707-03:00","close_reason":"Closed","dependencies":[{"issue_id":"gendocs-rss","depends_on_id":"gendocs-02x","type":"blocks","created_at":"2025-12-30T10:45:28.173247839-03:00","created_by":"daemon"}]}
{"id":"gendocs-t4o","title":"Implement saver_test.go with round-trip serialization tests","description":"Test SaveGlobalConfig, SaveProjectConfig, file permissions, and round-trip load-\u003esave-\u003eload","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T16:47:48.812463033-03:00","created_by":"diogo","updated_at":"2025-12-29T16:50:49.607724275-03:00","closed_at":"2025-12-29T16:50:49.607724275-03:00","close_reason":"Closed","labels":["config","test"],"dependencies":[{"issue_id":"gendocs-t4o","depends_on_id":"gendocs-fn3","type":"blocks","created_at":"2025-12-29T16:48:17.617444972-03:00","created_by":"daemon"}]}
{"id":"gendocs-wt1","title":"Create ai_rules_llm.go thin wrapper section for AI Rules generation LLM config","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-30T10:45:14.11065675-03:00","created_by":"diogo","updated_at":"2025-12-30T10:47:37.222983203-03:00","closed_at":"2025-12-30T10:47:37.222983203-03:00","close_reason":"Closed","dependencies":[{"issue_id":"gendocs-wt1","depends_on_id":"gendocs-02x","type":"blocks","created_at":"2025-12-30T10:45:28.178850504-03:00","created_by":"daemon"}]}
{"id":"gendocs-y41","title":"Update model.go populateSections and applyValuesToConfig for documenter and ai_rules LLM settings","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-30T10:45:16.474010116-03:00","created_by":"diogo","updated_at":"2025-12-30T10:49:22.874344317-03:00","closed_at":"2025-12-30T10:49:22.874344317-03:00","close_reason":"Closed","dependencies":[{"issue_id":"gendocs-y41","depends_on_id":"gendocs-rss","type":"blocks","created_at":"2025-12-30T10:45:28.203696729-03:00","created_by":"daemon"},{"issue_id":"gendocs-y41","depends_on_id":"gendocs-wt1","type":"blocks","created_at":"2025-12-30T10:45:28.208135425-03:00","created_by":"daemon"}]}
